# План структуры дизайна приложения Family Coin Tracker

## 1) Общая дизайн-концепция
- Форм-фактор: **mobile-first** интерфейс в карточном стиле, ограниченный контейнером `max-w-md` и ориентированный на использование как мобильного мини-приложения.
- Визуальный стиль: мягкие скругления (`rounded-2xl/3xl`), большие CTA-кнопки, акцент на изумрудном цвете для ключевых действий.
- Темизация: поддержка **light/dark** через токены темы.
- Поведение: плавные микроанимации (в Android-реализации — анимированные переходы между экранами и отклики на нажатие).

## 2) Каркас приложения (layout + навигация)

### 2.1 Глобальный уровень
- `CoinMetricRoot` подключает состояние `CoinMetricViewModel` и управляет экранной навигацией.

### 2.2 Маршруты (информационная архитектура)
- `/` — Dashboard (главная)
- `/calendar` — Календарь
- `/add` — Добавление операции
- `/analytics` — Аналитика
- `/settings` — Настройки
- `*` — Not Found (в мобильной реализации эквивалент — fallback на dashboard)

### 2.3 Общий мобильный контейнер
- `MobileLayout`:
  - Верхний header.
  - Скроллируемая центральная область.
  - Фиксированный bottom-nav с 5 пунктами.
  - Центральный action-элемент `Добавить` в виде плавающей круглой кнопки.

## 3) Структура экранов по блокам

### 3.1 Главная (`/` — dashboard)
1. Header с названием `CoinMetric`.
2. Hero-карта «Общий баланс»:
   - текущий баланс,
   - блок «Доход»,
   - блок «Расход».
3. Сетка быстрых метрик:
   - лимиты,
   - средний расход в день.
4. Блок «Тренд расходов».
5. Блок «Последние операции».

### 3.2 Добавление операции (`/add`)
1. Header: кнопка «Отмена», заголовок, пустой слот справа.
2. Ввод суммы.
3. Форма параметров:
   - категория,
   - заметка,
   - флаг доход/расход.
4. Большая кнопка `Сохранить`.

Поведение:
- Валидация обязательных полей (сумма + категория).
- Ошибки и успех показываются на экране.
- После успеха — возврат на главный экран.

### 3.3 Аналитика (`/analytics`)
1. Header: название + подзаголовок.
2. Карточка распределения расходов по категориям.
3. Список «Лимиты по категориям» с прогрессом.

### 3.4 Календарь (`/calendar`)
1. Header: название + подзаголовок.
2. Календарная карточка с группировкой транзакций по дате.
3. Секция выбранной даты / empty-state.

### 3.5 Настройки (`/settings`)
1. Header: название + подзаголовок.
2. Переключение темы (dark/light).
3. Блок синхронизации Google (switch).
4. Блок «Семейный доступ».
5. Общие настройки и выход.

## 4) Библиотека визуальных паттернов
- Карточки для ключевых сущностей.
- Типографика: заголовки крупнее, денежные значения акцентированы.
- Цветовая семантика:
  - primary (изумрудный) — ключевые действия,
  - muted — вторичная информация,
  - red — предупреждения/расход/выход.

## 5) Слой данных
- Источник данных: локальная база + `CoinMetricViewModel`.
- Структура готова к синхронизации (Google worker уже подключён).

## 6) Иерархия компонентов
- `MainActivity`
  - `CoinMetricTheme`
    - `CoinMetricRoot`
      - `MobileLayout`
        - Header
        - Контент экранов
        - Bottom navigation + центральный add-action

## 7) UX-заметки
- Сильные стороны:
  - единый визуальный язык,
  - удобная нижняя навигация,
  - заметные CTA.
- Зоны роста:
  - унификация валюты,
  - больше состояний загрузки,
  - расширение доступности форм ввода.

## 8) Отметка выполненных изменений
- [x] Добавлен `CoinMetricRoot` с навигацией по маршрутам `/`, `/calendar`, `/add`, `/analytics`, `/settings` и fallback на dashboard через `startDestination`.
- [x] Реализован `MobileLayout`: верхний header, скроллируемый контент и нижняя навигация с центральным add-action.
- [x] Собран экран dashboard по плану: баланс, доход/расход, быстрые метрики, тренд и последние операции.
- [x] Собран экран добавления операции с валидацией суммы+категории, статусами ошибок/успеха и возвратом на главный экран.
- [x] Добавлены экраны аналитики, календаря и настроек согласно структуре блоков.
- [x] Подключена тема `CoinMetricTheme` с light/dark палитрами и едиными скруглениями.
- [x] Обновлён верхний header: добавлены контекстные подзаголовки для разделов и действие `Отмена` на экране `/add`.
- [x] Нижняя навигация приведена к 4 разделам, а действие `Добавить` вынесено в центральную плавающую кнопку.

- [x] Переключение тёмной темы из настроек теперь применяется глобально через `CoinMetricTheme` в корне приложения.
- [x] Экран аналитики дополнен визуальным прогрессом лимитов по категориям (`LinearProgressIndicator`).
- [x] Экран календаря показывает группировку последних операций по дате вместо одного фиксированного дня.
